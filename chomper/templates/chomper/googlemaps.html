<!DOCTYPE html>
<html>
    {% include 'chomper/base.html' %}
	{% load leaflet_tags %}
	{% load geojson_tags %}
    <style>
      /*.form-google {*/
        /*max-width: 550px;*/
        /*padding: 15px;*/
        /*margin: 0 auto;*/
      /*}*/
	  /*.row {*/
        /*max-width: 550px;*/
        /*padding: 15px;*/
        /*margin: 0 auto;*/
      /*}*/
	  .leaflet-container {  /* all maps */
        width:  800px;
        height: 500px;
		  margin: 0 auto;
    }
		.dropdown {
		max-width: 550px;
        padding: 15px;
        margin: 0 auto;
    }
		body {
    	background-color: #48B8D2;
	}
    </style>


	<head>
		{% leaflet_js %}
		{% leaflet_css %}
	</head>

    <body>

	  <section class="row">
		  <div class="container">
			  <form class="form-google" id="google_form" method="post" action="/chomper/googlemaps/">
          			{% csrf_token %}
          			{% load bootstrap %}
				  <div class="col-sm-6">

					  <div class="col-xs-12 text-center">
						  <h2>Google API</h2>
					  </div>

						<input type="text" name="origin" class="form-control" placeholder="Enter an origin" value="" required autofocus>
						<input type="text" name="destination" class="form-control" placeholder="Enter a destination" value="" required autofocus>
						<div class='wrapper text-center'>
							<div class="btn-group text-center" data-toggle="buttons">
								<label class="btn btn-default">
									<input type="radio" id="q156" name="mode" value="driving" /> Driving
								</label>
								<label class="btn btn-default">
									<input type="radio" id="q157" name="mode" value="transit" /> Transit
								</label>
								<label class="btn btn-default">
									<input type="radio" id="q158" name="mode" value="walking" checked="checked" /> Walking
								</label>
							</div>
						</div>

			  		</div>

				  <div class="col-sm-6">

					  <div class="col-xs-12 text-center">
						  <h2>Yelp API</h2>
					  </div>

					<div class="col-xs-12 text-center">
						<input type="text" name="cuisine" class="form-control" placeholder="Enter a cuisine" value="" required autofocus>
					</div>

					<div class='wrapper text-center'>
						<div class="col-xs-12 text-center">
							<div class="btn-group" data-toggle="buttons">
								<label class="btn btn-default">
									<input type="radio" name="cost" value="1" checked="checked" /> $
								</label>
								<label class="btn btn-default">
									<input type="radio" name="cost" value="2" /> $$
								</label>
								<label class="btn btn-default">
									<input type="radio" name="cost" value="3" /> $$$
								</label>
								<label class="btn btn-default">
									<input type="radio" name="cost" value="4" /> $$$$
								</label>
							</div>
						</div>
					</div>

				  	<div class='wrapper text-center'>
						<div class="col-xs-12 text-center">
							<div class="checkbox">
								<label><input type="checkbox" value="">Only show 'Open Now'?</label>
							</div>
						</div>
					</div>
				  </div>

				  <button class="btn btn-lg btn-primary btn-block" type="submit">Search</button>
				  <input type="hidden" name="submit" value="submit" />
			  </form>

			  </div>
		  </div>
	  </section>


		{% leaflet_map "spots" callback="map_init" %}
		<script type="text/javascript">
		// IE9 fix
		if(!window.console) {
			var console = {
				log : function(){},
				warn : function(){},
				error : function(){},
				time : function(){},
				timeEnd : function(){}
			}
			}
			function onEachFeature(feature, layer) {
    			if (feature.properties && feature.properties.popupContent) {
					console.log(5 + 6);
      				layer.bindPopup(feature.properties.popupContent);
    				}
			}

			function map_init (map, options) {

				var dataurl = '{% url "data" %}';
				// Download GeoJSON via Ajax
				$.getJSON(dataurl, function (data) {
					// Add GeoJSON layer
					L.geoJson(data).addTo(map);
				});

				var datapointsurl = '{% url "datapoints" %}';
				// Download GeoJSON via Ajax
				$.getJSON(datapointsurl, function (data) {
					// Add GeoJSON layer
					L.geoJson(data, {onEachFeature: onEachFeature}).addTo(map);
				});

			}
		</script>
      	{% if data %}
	      <div class="col-lg-12">
	        <div class="table-responsive">
	            <table class="table table-bordered table-hover table-striped tablesorter">
	                <thead>
	                <tr>
	                <th class="header"> Name <i class="icon-sort"></i></th>
					<th class="header"> Rating <i class="icon-sort"></i></th>
	                <th class="header"> Address <i class="icon-sort"></i></th>
	                <th class="header"> Cuisine <i class="icon-sort"></i></th>
	                <th class="header"> Neighborhood <i class="icon-sort"></i></th>
					<th class="header"> URL <i class="icon-sort"></i></th>
	                </tr>
	            </thead>
	            <tbody>
					{% for key in data %}
					<tr>
	                    <td>{{ key.name }}</td>
	                    <td>{{ key.rating }}</td>
	                    <td>{{ key.address }}</td>
	                    <td>{{ key.cuisine }}</td>
						<td>{{ key.neighborhood }}</td>
	                    <td>{{ key.url |urlize }}</td>
	    			</tr>
	            	{% endfor %}
	            </tbody>
	            </table>
	        </div>
	      </div>

	    {% endif %}

    </body>
</html>